"""rec

Revision ID: 780a0831f2f7
Revises: 
Create Date: 2025-12-29 05:08:54.582534

"""
from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import mysql

# revision identifiers, used by Alembic.
revision: str = '780a0831f2f7'
down_revision: Union[str, Sequence[str], None] = None
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    """Upgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('college',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='学院ID'),
    sa.Column('college_code', sa.String(length=32), nullable=False, comment='学院编码'),
    sa.Column('college_name', sa.String(length=64), nullable=False, comment='学院名称'),
    sa.Column('short_name', sa.String(length=16), nullable=True, comment='学院简称（可空）'),
    sa.Column('sort_order', sa.SmallInteger(), nullable=True, comment='排序'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.Column('is_delete', sa.Boolean(), nullable=True, comment='逻辑删除'),
    sa.PrimaryKeyConstraint('id'),
    comment='学院表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_college_delete', 'college', ['is_delete'], unique=False)
    op.create_index(op.f('ix_college_college_code'), 'college', ['college_code'], unique=True)
    op.create_index(op.f('ix_college_is_delete'), 'college', ['is_delete'], unique=False)
    op.create_table('evaluation_dimension',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='维度ID'),
    sa.Column('dimension_code', sa.String(length=32), nullable=False, comment='维度编码'),
    sa.Column('dimension_name', sa.String(length=64), nullable=False, comment='维度名称'),
    sa.Column('max_score', mysql.TINYINT(), nullable=False, comment='该维度最高分'),
    sa.Column('weight', sa.DECIMAL(precision=3, scale=2), nullable=False, comment='权重'),
    sa.Column('sort_order', sa.SmallInteger(), nullable=True, comment='排序'),
    sa.Column('description', sa.String(length=256), nullable=True, comment='维度说明（可空）'),
    sa.Column('scoring_criteria', sa.JSON(), nullable=True, comment='评分标准说明（可空）'),
    sa.Column('is_required', sa.Boolean(), nullable=True, comment='是否必填'),
    sa.Column('status', mysql.TINYINT(), nullable=True, comment='状态 1-启用 0-禁用'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.Column('is_delete', sa.Boolean(), nullable=True, comment='逻辑删除'),
    sa.PrimaryKeyConstraint('id'),
    comment='评价维度配置表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_dimension_delete', 'evaluation_dimension', ['is_delete'], unique=False)
    op.create_index('idx_dimension_status_order', 'evaluation_dimension', ['status', 'sort_order'], unique=False)
    op.create_index(op.f('ix_evaluation_dimension_dimension_code'), 'evaluation_dimension', ['dimension_code'], unique=True)
    op.create_index(op.f('ix_evaluation_dimension_is_delete'), 'evaluation_dimension', ['is_delete'], unique=False)
    op.create_table('login_log_archive',
    sa.Column('id', sa.BigInteger(), nullable=False, comment='原日志ID'),
    sa.Column('user_id', sa.BigInteger(), nullable=True, comment='用户ID（可空）'),
    sa.Column('user_name', sa.String(length=64), nullable=True, comment='用户名（可空）'),
    sa.Column('login_type', sa.String(length=16), nullable=False, comment='登录类型'),
    sa.Column('login_status', mysql.TINYINT(), nullable=False, comment='登录状态'),
    sa.Column('ip_address', sa.String(length=45), nullable=True, comment='IP地址（可空）'),
    sa.Column('location', sa.String(length=64), nullable=True, comment='登录地点（可空）'),
    sa.Column('create_time', sa.DateTime(), nullable=True, comment='登录时间'),
    sa.Column('create_date', sa.String(length=10), nullable=True, comment='创建日期'),
    sa.Column('archive_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='归档时间'),
    sa.PrimaryKeyConstraint('id'),
    comment='登录日志归档表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_login_archive_date', 'login_log_archive', ['create_date'], unique=False)
    op.create_index(op.f('ix_login_log_archive_create_date'), 'login_log_archive', ['create_date'], unique=False)
    op.create_index(op.f('ix_login_log_archive_create_time'), 'login_log_archive', ['create_time'], unique=False)
    op.create_table('operation_log_archive',
    sa.Column('id', sa.BigInteger(), nullable=False, comment='原日志ID'),
    sa.Column('user_id', sa.BigInteger(), nullable=True, comment='操作用户ID'),
    sa.Column('user_name', sa.String(length=64), nullable=True, comment='操作用户名'),
    sa.Column('operation_type', sa.String(length=32), nullable=False, comment='操作类型'),
    sa.Column('module', sa.String(length=32), nullable=False, comment='模块'),
    sa.Column('target_id', sa.BigInteger(), nullable=True, comment='操作目标ID（可空）'),
    sa.Column('target_type', sa.String(length=32), nullable=True, comment='操作目标类型（可空）'),
    sa.Column('content', sa.JSON(), nullable=True, comment='操作详情（可空）'),
    sa.Column('ip_address', sa.String(length=45), nullable=True, comment='IP地址（可空）'),
    sa.Column('create_time', sa.DateTime(), nullable=True, comment='创建时间'),
    sa.Column('create_date', sa.String(length=10), nullable=True, comment='创建日期'),
    sa.Column('archive_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='归档时间'),
    sa.PrimaryKeyConstraint('id'),
    comment='操作日志归档表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_archive_date', 'operation_log_archive', ['create_date'], unique=False)
    op.create_index('idx_archive_user', 'operation_log_archive', ['user_id', 'create_time'], unique=False)
    op.create_index(op.f('ix_operation_log_archive_create_date'), 'operation_log_archive', ['create_date'], unique=False)
    op.create_index(op.f('ix_operation_log_archive_create_time'), 'operation_log_archive', ['create_time'], unique=False)
    op.create_table('permission',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='权限ID'),
    sa.Column('permission_code', sa.String(length=64), nullable=False, comment='权限编码'),
    sa.Column('permission_name', sa.String(length=128), nullable=False, comment='权限名称'),
    sa.Column('permission_type', mysql.TINYINT(), nullable=False, comment='权限类型 1-查看 2-操作 3-导出 4-配置'),
    sa.Column('parent_id', sa.BigInteger(), nullable=True, comment='父权限ID（可空）'),
    sa.Column('sort_order', sa.SmallInteger(), nullable=True, comment='排序'),
    sa.Column('permission_description', sa.String(length=256), nullable=True, comment='权限描述（可空）'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('is_delete', sa.Boolean(), nullable=True, comment='逻辑删除'),
    sa.ForeignKeyConstraint(['parent_id'], ['permission.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    comment='权限表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_permission_type_order', 'permission', ['permission_type', 'sort_order'], unique=False)
    op.create_index(op.f('ix_permission_is_delete'), 'permission', ['is_delete'], unique=False)
    op.create_index(op.f('ix_permission_parent_id'), 'permission', ['parent_id'], unique=False)
    op.create_index(op.f('ix_permission_permission_code'), 'permission', ['permission_code'], unique=True)
    op.create_index(op.f('ix_permission_permission_type'), 'permission', ['permission_type'], unique=False)
    op.create_table('role',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='角色ID'),
    sa.Column('role_code', sa.String(length=64), nullable=False, comment='角色编码'),
    sa.Column('role_name', sa.String(length=128), nullable=False, comment='角色名称'),
    sa.Column('role_level', mysql.TINYINT(), nullable=True, comment='角色级别（用于权限继承/排序）'),
    sa.Column('description', sa.String(length=256), nullable=True, comment='角色描述（可空）'),
    sa.Column('status', mysql.TINYINT(), nullable=True, comment='状态 1-启用 0-禁用'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('is_delete', sa.Boolean(), nullable=True, comment='逻辑删除'),
    sa.PrimaryKeyConstraint('id'),
    comment='角色表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_role_status_delete', 'role', ['status', 'is_delete'], unique=False)
    op.create_index(op.f('ix_role_is_delete'), 'role', ['is_delete'], unique=False)
    op.create_index(op.f('ix_role_role_code'), 'role', ['role_code'], unique=True)
    op.create_index(op.f('ix_role_status'), 'role', ['status'], unique=False)
    op.create_table('college_evaluation_stat',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='统计记录ID'),
    sa.Column('college_id', sa.BigInteger(), nullable=False, comment='学院ID'),
    sa.Column('stat_year', sa.String(length=9), nullable=False, comment='统计学年'),
    sa.Column('stat_semester', mysql.TINYINT(), nullable=False, comment='统计学期 1-春季 2-秋季'),
    sa.Column('total_teacher_num', sa.SmallInteger(), nullable=True, comment='参评教师总数'),
    sa.Column('total_evaluation_num', sa.SmallInteger(), nullable=True, comment='评价总次数'),
    sa.Column('avg_total_score', sa.DECIMAL(precision=5, scale=2), nullable=True, comment='学院总平均分（可空）'),
    sa.Column('dimension_avg_scores', sa.JSON(), nullable=True, comment='学院各维度平均分（可空）'),
    sa.Column('school_rank', sa.SmallInteger(), nullable=True, comment='学院全校排名（可空）'),
    sa.Column('school_total', sa.SmallInteger(), nullable=True, comment='参评学院总数（可空）'),
    sa.Column('high_freq_problems', sa.JSON(), nullable=True, comment='学院高频问题（可空）'),
    sa.Column('score_distribution', sa.JSON(), nullable=True, comment='分数分布（可空）'),
    sa.Column('excellent_rate', sa.DECIMAL(precision=5, scale=2), nullable=True, comment='优秀率（可空）'),
    sa.Column('report_export_num', sa.SmallInteger(), nullable=True, comment='报表导出次数'),
    sa.Column('last_export_time', sa.DateTime(), nullable=True, comment='最后导出时间（可空）'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.ForeignKeyConstraint(['college_id'], ['college.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('college_id', 'stat_year', 'stat_semester', name='uk_college_stat_period'),
    comment='学院评价统计表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_college_stat_year_semester', 'college_evaluation_stat', ['stat_year', 'stat_semester'], unique=False)
    op.create_index(op.f('ix_college_evaluation_stat_college_id'), 'college_evaluation_stat', ['college_id'], unique=False)
    op.create_index(op.f('ix_college_evaluation_stat_stat_year'), 'college_evaluation_stat', ['stat_year'], unique=False)
    op.create_table('major',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='专业ID'),
    sa.Column('major_code', sa.String(length=32), nullable=True, comment='专业编码（可空）'),
    sa.Column('major_name', sa.String(length=64), nullable=False, comment='专业名称'),
    sa.Column('short_name', sa.String(length=32), nullable=True, comment='专业简称（可空）'),
    sa.Column('college_id', sa.BigInteger(), nullable=False, comment='学院ID'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.Column('is_delete', sa.Boolean(), nullable=True, comment='逻辑删除'),
    sa.ForeignKeyConstraint(['college_id'], ['college.id'], ondelete='RESTRICT'),
    sa.PrimaryKeyConstraint('id'),
    comment='专业表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_major_delete', 'major', ['is_delete'], unique=False)
    op.create_index(op.f('ix_major_college_id'), 'major', ['college_id'], unique=False)
    op.create_index(op.f('ix_major_is_delete'), 'major', ['is_delete'], unique=False)
    op.create_index(op.f('ix_major_major_code'), 'major', ['major_code'], unique=True)
    op.create_table('research_room',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='教研室ID'),
    sa.Column('room_name', sa.String(length=64), nullable=False, comment='教研室名称'),
    sa.Column('college_id', sa.BigInteger(), nullable=False, comment='学院ID'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.Column('is_delete', sa.Boolean(), nullable=True, comment='逻辑删除'),
    sa.ForeignKeyConstraint(['college_id'], ['college.id'], ondelete='RESTRICT'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('college_id', 'room_name', name='uk_room_college_name'),
    comment='教研室表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_room_delete', 'research_room', ['is_delete'], unique=False)
    op.create_index(op.f('ix_research_room_college_id'), 'research_room', ['college_id'], unique=False)
    op.create_index(op.f('ix_research_room_is_delete'), 'research_room', ['is_delete'], unique=False)
    op.create_table('role_permission',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False),
    sa.Column('role_id', sa.BigInteger(), nullable=False),
    sa.Column('permission_id', sa.BigInteger(), nullable=False),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.ForeignKeyConstraint(['permission_id'], ['permission.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['role_id'], ['role.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('role_id', 'permission_id', name='uk_role_permission'),
    comment='角色权限关联表',
    mysql_charset='utf8mb4'
    )
    op.create_index(op.f('ix_role_permission_permission_id'), 'role_permission', ['permission_id'], unique=False)
    op.create_index(op.f('ix_role_permission_role_id'), 'role_permission', ['role_id'], unique=False)
    op.create_table('user',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='用户ID'),
    sa.Column('user_on', sa.String(length=32), nullable=False, comment='工号/账号'),
    sa.Column('user_name', sa.String(length=64), nullable=False, comment='用户名/姓名'),
    sa.Column('college_id', sa.BigInteger(), nullable=True, comment='所属学院ID（可空）'),
    sa.Column('password', sa.String(length=255), nullable=False, comment='密码（bcrypt加密）'),
    sa.Column('status', mysql.TINYINT(), nullable=True, comment='状态 1-启用 0-禁用'),
    sa.Column('token', sa.String(length=512), nullable=True, comment='用户token'),
    sa.Column('refresh_token', sa.String(length=512), nullable=True, comment='refresh_token'),
    sa.Column('token_expire_time', sa.DateTime(), nullable=True, comment='token过期时间'),
    sa.Column('last_login_time', sa.DateTime(), nullable=True, comment='最近登录时间'),
    sa.Column('last_login_ip', sa.String(length=45), nullable=True, comment='最近登录IP（支持IPv6）'),
    sa.Column('login_fail_count', mysql.TINYINT(), nullable=True, comment='连续登录失败次数'),
    sa.Column('lock_until', sa.DateTime(), nullable=True, comment='锁定截止时间'),
    sa.Column('nnlg_key', sa.String(length=128), nullable=True, comment='教务系统登录key（可选）'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.Column('is_delete', sa.Boolean(), nullable=True, comment='逻辑删除'),
    sa.ForeignKeyConstraint(['college_id'], ['college.id'], ondelete='SET NULL'),
    sa.PrimaryKeyConstraint('id'),
    comment='用户表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_user_status_delete', 'user', ['status', 'is_delete'], unique=False)
    op.create_index('idx_user_token', 'user', ['token'], unique=False)
    op.create_index(op.f('ix_user_college_id'), 'user', ['college_id'], unique=False)
    op.create_index(op.f('ix_user_is_delete'), 'user', ['is_delete'], unique=False)
    op.create_index(op.f('ix_user_status'), 'user', ['status'], unique=False)
    op.create_index(op.f('ix_user_user_on'), 'user', ['user_on'], unique=True)
    op.create_table('clazz',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='班级ID'),
    sa.Column('class_code', sa.String(length=32), nullable=True, comment='班级编号（可空）'),
    sa.Column('class_name', sa.String(length=64), nullable=False, comment='班级名称'),
    sa.Column('grade', sa.String(length=16), nullable=True, comment='年级（可空）'),
    sa.Column('major_id', sa.BigInteger(), nullable=True, comment='专业ID（可空）'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.Column('is_delete', sa.Boolean(), nullable=True, comment='逻辑删除'),
    sa.ForeignKeyConstraint(['major_id'], ['major.id'], ondelete='SET NULL'),
    sa.PrimaryKeyConstraint('id'),
    comment='班级表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_clazz_delete', 'clazz', ['is_delete'], unique=False)
    op.create_index(op.f('ix_clazz_class_code'), 'clazz', ['class_code'], unique=True)
    op.create_index(op.f('ix_clazz_class_name'), 'clazz', ['class_name'], unique=False)
    op.create_index(op.f('ix_clazz_is_delete'), 'clazz', ['is_delete'], unique=False)
    op.create_index(op.f('ix_clazz_major_id'), 'clazz', ['major_id'], unique=False)
    op.create_table('login_log',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='日志ID'),
    sa.Column('user_id', sa.BigInteger(), nullable=True, comment='用户ID（可空）'),
    sa.Column('user_name', sa.String(length=64), nullable=True, comment='用户名/工号（可空）'),
    sa.Column('login_type', sa.String(length=16), nullable=False, comment='登录类型 PASSWORD/WECHAT/TOKEN'),
    sa.Column('login_status', mysql.TINYINT(), nullable=False, comment='登录状态 1-成功 0-失败'),
    sa.Column('fail_reason', sa.String(length=128), nullable=True, comment='失败原因（可空）'),
    sa.Column('ip_address', sa.String(length=45), nullable=True, comment='IP地址（可空）'),
    sa.Column('location', sa.String(length=64), nullable=True, comment='登录地点（可空）'),
    sa.Column('device_type', sa.String(length=32), nullable=True, comment='设备类型（可空）'),
    sa.Column('browser', sa.String(length=64), nullable=True, comment='浏览器（可空）'),
    sa.Column('os', sa.String(length=64), nullable=True, comment='操作系统（可空）'),
    sa.Column('user_agent', sa.String(length=512), nullable=True, comment='User-Agent（可空）'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='登录时间'),
    sa.Column('create_date', sa.String(length=10), nullable=False, comment='创建日期YYYY-MM-DD'),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ondelete='SET NULL'),
    sa.PrimaryKeyConstraint('id'),
    comment='登录日志表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_login_date', 'login_log', ['create_date'], unique=False)
    op.create_index('idx_login_status_time', 'login_log', ['login_status', 'create_time'], unique=False)
    op.create_index('idx_login_user_time', 'login_log', ['user_id', 'create_time'], unique=False)
    op.create_index(op.f('ix_login_log_create_date'), 'login_log', ['create_date'], unique=False)
    op.create_index(op.f('ix_login_log_create_time'), 'login_log', ['create_time'], unique=False)
    op.create_index(op.f('ix_login_log_user_id'), 'login_log', ['user_id'], unique=False)
    op.create_table('operation_log',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='日志ID'),
    sa.Column('user_id', sa.BigInteger(), nullable=True, comment='操作用户ID（可空）'),
    sa.Column('user_name', sa.String(length=64), nullable=True, comment='操作用户名（冗余，防止用户删除后丢失）'),
    sa.Column('operation_type', sa.String(length=32), nullable=False, comment='操作类型'),
    sa.Column('module', sa.String(length=32), nullable=False, comment='模块'),
    sa.Column('target_id', sa.BigInteger(), nullable=True, comment='操作目标ID（可空）'),
    sa.Column('target_type', sa.String(length=32), nullable=True, comment='操作目标类型（可空）'),
    sa.Column('content', sa.JSON(), nullable=True, comment='操作详情（可空）'),
    sa.Column('before_data', sa.JSON(), nullable=True, comment='操作前数据（可空）'),
    sa.Column('after_data', sa.JSON(), nullable=True, comment='操作后数据（可空）'),
    sa.Column('ip_address', sa.String(length=45), nullable=True, comment='IP地址（可空）'),
    sa.Column('user_agent', sa.String(length=512), nullable=True, comment='User-Agent（可空）'),
    sa.Column('request_url', sa.String(length=256), nullable=True, comment='请求URL（可空）'),
    sa.Column('request_method', sa.String(length=10), nullable=True, comment='请求方法（可空）'),
    sa.Column('response_code', sa.SmallInteger(), nullable=True, comment='响应状态码（可空）'),
    sa.Column('execute_time', sa.SmallInteger(), nullable=True, comment='执行耗时(ms，可空)'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('create_date', sa.String(length=10), nullable=False, comment='创建日期YYYY-MM-DD（用于分区/归档）'),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ondelete='SET NULL'),
    sa.PrimaryKeyConstraint('id'),
    comment='操作日志表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_log_date', 'operation_log', ['create_date'], unique=False)
    op.create_index('idx_log_module_type', 'operation_log', ['module', 'operation_type'], unique=False)
    op.create_index('idx_log_target', 'operation_log', ['target_type', 'target_id'], unique=False)
    op.create_index('idx_log_user_time', 'operation_log', ['user_id', 'create_time'], unique=False)
    op.create_index(op.f('ix_operation_log_create_date'), 'operation_log', ['create_date'], unique=False)
    op.create_index(op.f('ix_operation_log_create_time'), 'operation_log', ['create_time'], unique=False)
    op.create_index(op.f('ix_operation_log_module'), 'operation_log', ['module'], unique=False)
    op.create_index(op.f('ix_operation_log_operation_type'), 'operation_log', ['operation_type'], unique=False)
    op.create_index(op.f('ix_operation_log_user_id'), 'operation_log', ['user_id'], unique=False)
    op.create_table('system_config',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='配置ID'),
    sa.Column('config_key', sa.String(length=64), nullable=False, comment='配置键'),
    sa.Column('config_value', sa.JSON(), nullable=False, comment='配置值（JSON）'),
    sa.Column('config_type', sa.String(length=32), nullable=True, comment='配置类型 string/number/boolean/json'),
    sa.Column('config_desc', sa.String(length=256), nullable=False, comment='配置描述'),
    sa.Column('is_public', sa.Boolean(), nullable=True, comment='是否前端可见'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.Column('operator_id', sa.BigInteger(), nullable=True, comment='操作人ID（可空）'),
    sa.ForeignKeyConstraint(['operator_id'], ['user.id'], ondelete='SET NULL'),
    sa.PrimaryKeyConstraint('id'),
    comment='系统配置表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index(op.f('ix_system_config_config_key'), 'system_config', ['config_key'], unique=True)
    op.create_index(op.f('ix_system_config_operator_id'), 'system_config', ['operator_id'], unique=False)
    op.create_table('teacher_evaluation_stat',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='统计记录ID'),
    sa.Column('teacher_id', sa.BigInteger(), nullable=False, comment='教师ID（user.id）'),
    sa.Column('college_id', sa.BigInteger(), nullable=False, comment='所属学院ID'),
    sa.Column('stat_year', sa.String(length=9), nullable=False, comment='统计学年（如2024-2025）'),
    sa.Column('stat_semester', mysql.TINYINT(), nullable=False, comment='统计学期 1-春季 2-秋季'),
    sa.Column('total_evaluation_num', sa.SmallInteger(), nullable=True, comment='评教总次数'),
    sa.Column('avg_total_score', sa.DECIMAL(precision=5, scale=2), nullable=True, comment='总分平均分（可空）'),
    sa.Column('max_score', mysql.TINYINT(), nullable=True, comment='最高分（可空）'),
    sa.Column('min_score', mysql.TINYINT(), nullable=True, comment='最低分（可空）'),
    sa.Column('dimension_avg_scores', sa.JSON(), nullable=True, comment='各维度平均分（可空）'),
    sa.Column('school_rank', sa.SmallInteger(), nullable=True, comment='全校排名（可空）'),
    sa.Column('school_total', sa.SmallInteger(), nullable=True, comment='全校参评教师总数（可空）'),
    sa.Column('college_rank', sa.SmallInteger(), nullable=True, comment='院内排名（可空）'),
    sa.Column('college_total', sa.SmallInteger(), nullable=True, comment='院内参评教师总数（可空）'),
    sa.Column('high_freq_problems', sa.JSON(), nullable=True, comment='高频问题（可空）'),
    sa.Column('high_freq_suggestions', sa.JSON(), nullable=True, comment='高频建议（可空）'),
    sa.Column('score_distribution', sa.JSON(), nullable=True, comment='分数分布（可空）'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.ForeignKeyConstraint(['college_id'], ['college.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['teacher_id'], ['user.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('teacher_id', 'stat_year', 'stat_semester', name='uk_teacher_stat_period'),
    comment='教师评价统计表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_teacher_stat_college', 'teacher_evaluation_stat', ['college_id', 'stat_year', 'stat_semester'], unique=False)
    op.create_index('idx_teacher_stat_year_semester', 'teacher_evaluation_stat', ['stat_year', 'stat_semester'], unique=False)
    op.create_index(op.f('ix_teacher_evaluation_stat_college_id'), 'teacher_evaluation_stat', ['college_id'], unique=False)
    op.create_index(op.f('ix_teacher_evaluation_stat_stat_year'), 'teacher_evaluation_stat', ['stat_year'], unique=False)
    op.create_index(op.f('ix_teacher_evaluation_stat_teacher_id'), 'teacher_evaluation_stat', ['teacher_id'], unique=False)
    op.create_table('teacher_profile',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='教师档案ID'),
    sa.Column('user_id', sa.BigInteger(), nullable=False, comment='用户ID（user.id）'),
    sa.Column('title', sa.String(length=32), nullable=True, comment='职称（可空）'),
    sa.Column('research_room_id', sa.BigInteger(), nullable=True, comment='教研室ID（可空）'),
    sa.Column('external_id', sa.String(length=64), nullable=True, comment='教务教师唯一ID（可空）'),
    sa.Column('raw_payload', sa.JSON(), nullable=True, comment='教务原始数据（可空）'),
    sa.Column('sync_time', sa.DateTime(), nullable=True, comment='最后同步时间（可空）'),
    sa.Column('sync_status', mysql.TINYINT(), nullable=True, comment='同步状态 1-成功 0-失败'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.Column('is_delete', sa.Boolean(), nullable=True, comment='逻辑删除'),
    sa.ForeignKeyConstraint(['research_room_id'], ['research_room.id'], ondelete='SET NULL'),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('external_id', name='uk_teacher_profile_external_id'),
    comment='教师扩展档案表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_teacher_profile_delete', 'teacher_profile', ['is_delete'], unique=False)
    op.create_index(op.f('ix_teacher_profile_external_id'), 'teacher_profile', ['external_id'], unique=False)
    op.create_index(op.f('ix_teacher_profile_is_delete'), 'teacher_profile', ['is_delete'], unique=False)
    op.create_index(op.f('ix_teacher_profile_research_room_id'), 'teacher_profile', ['research_room_id'], unique=False)
    op.create_index(op.f('ix_teacher_profile_user_id'), 'teacher_profile', ['user_id'], unique=True)
    op.create_table('user_role',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False),
    sa.Column('user_id', sa.BigInteger(), nullable=False),
    sa.Column('role_id', sa.BigInteger(), nullable=False),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.ForeignKeyConstraint(['role_id'], ['role.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('user_id', 'role_id', name='uk_user_role'),
    comment='用户角色关联表',
    mysql_charset='utf8mb4'
    )
    op.create_index(op.f('ix_user_role_role_id'), 'user_role', ['role_id'], unique=False)
    op.create_index(op.f('ix_user_role_user_id'), 'user_role', ['user_id'], unique=False)
    op.create_table('user_wechat_bind',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='绑定ID'),
    sa.Column('user_id', sa.BigInteger(), nullable=False, comment='用户ID'),
    sa.Column('openid', sa.String(length=64), nullable=False, comment='微信openid'),
    sa.Column('unionid', sa.String(length=64), nullable=True, comment='微信unionid（可空）'),
    sa.Column('session_key', sa.String(length=64), nullable=True, comment='session_key（可空）'),
    sa.Column('nickname', sa.String(length=64), nullable=True, comment='微信昵称（可空）'),
    sa.Column('avatar_url', sa.String(length=512), nullable=True, comment='微信头像（可空）'),
    sa.Column('bind_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='绑定时间'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.ForeignKeyConstraint(['user_id'], ['user.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('user_id'),
    comment='用户微信绑定表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index(op.f('ix_user_wechat_bind_openid'), 'user_wechat_bind', ['openid'], unique=True)
    op.create_index(op.f('ix_user_wechat_bind_unionid'), 'user_wechat_bind', ['unionid'], unique=True)
    op.create_table('timetable',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='课表记录ID'),
    sa.Column('college_id', sa.BigInteger(), nullable=True, comment='所属学院ID（可空）'),
    sa.Column('teacher_id', sa.BigInteger(), nullable=False, comment='授课教师ID（user.id）'),
    sa.Column('class_id', sa.BigInteger(), nullable=True, comment='班级ID（可空）'),
    sa.Column('class_name', sa.String(length=128), nullable=False, comment='授课班级名称（快照）'),
    sa.Column('course_code', sa.String(length=32), nullable=True, comment='课程编码（可空）'),
    sa.Column('course_name', sa.String(length=128), nullable=False, comment='课程名称'),
    sa.Column('academic_year', sa.String(length=9), nullable=False, comment='学年（如2024-2025）'),
    sa.Column('semester', mysql.TINYINT(), nullable=False, comment='学期 1-春季 2-秋季'),
    sa.Column('weekday', mysql.TINYINT(), nullable=False, comment='星期 1-7'),
    sa.Column('weekday_text', sa.String(length=8), nullable=True, comment='星期文本（可空，如星期四）'),
    sa.Column('period', sa.String(length=16), nullable=False, comment='节次（大节，如第一大节）'),
    sa.Column('section_time', sa.String(length=16), nullable=False, comment='小节范围（如01-02）'),
    sa.Column('week_info', sa.String(length=128), nullable=False, comment='上课周次（逗号列表，如1,2,3,4,...)'),
    sa.Column('classroom', sa.String(length=128), nullable=False, comment='教室（空字符串表示未知）'),
    sa.Column('student_count', sa.SmallInteger(), nullable=True, comment='学生人数（可空）'),
    sa.Column('credit', sa.DECIMAL(precision=3, scale=1), nullable=True, comment='学分（可空）'),
    sa.Column('course_type', sa.String(length=32), nullable=True, comment='课程类型（可空：必修/选修/实训...）'),
    sa.Column('sync_source', mysql.TINYINT(), nullable=True, comment='数据来源 0-手工/系统内 1-教务'),
    sa.Column('external_id', sa.String(length=64), nullable=True, comment='教务课表唯一ID（可空）'),
    sa.Column('raw_payload', sa.JSON(), nullable=True, comment='教务原始数据（可空）'),
    sa.Column('sync_time', sa.DateTime(), nullable=True, comment='最后同步时间（可空）'),
    sa.Column('sync_status', mysql.TINYINT(), nullable=True, comment='同步状态 1-成功 0-失败'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.Column('is_delete', sa.Boolean(), nullable=True, comment='逻辑删除'),
    sa.ForeignKeyConstraint(['class_id'], ['clazz.id'], ondelete='SET NULL'),
    sa.ForeignKeyConstraint(['college_id'], ['college.id'], ondelete='SET NULL'),
    sa.ForeignKeyConstraint(['teacher_id'], ['user.id'], ondelete='RESTRICT'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('academic_year', 'semester', 'teacher_id', 'class_name', 'course_name', 'weekday', 'period', 'section_time', 'week_info', 'classroom', name='uk_timetable_slot'),
    sa.UniqueConstraint('sync_source', 'external_id', name='uk_timetable_source_external'),
    comment='课表表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_timetable_college_teacher', 'timetable', ['college_id', 'teacher_id'], unique=False)
    op.create_index('idx_timetable_delete', 'timetable', ['is_delete'], unique=False)
    op.create_index('idx_timetable_schedule', 'timetable', ['weekday', 'period'], unique=False)
    op.create_index('idx_timetable_year_semester', 'timetable', ['academic_year', 'semester'], unique=False)
    op.create_index(op.f('ix_timetable_academic_year'), 'timetable', ['academic_year'], unique=False)
    op.create_index(op.f('ix_timetable_class_id'), 'timetable', ['class_id'], unique=False)
    op.create_index(op.f('ix_timetable_college_id'), 'timetable', ['college_id'], unique=False)
    op.create_index(op.f('ix_timetable_course_code'), 'timetable', ['course_code'], unique=False)
    op.create_index(op.f('ix_timetable_course_name'), 'timetable', ['course_name'], unique=False)
    op.create_index(op.f('ix_timetable_external_id'), 'timetable', ['external_id'], unique=False)
    op.create_index(op.f('ix_timetable_is_delete'), 'timetable', ['is_delete'], unique=False)
    op.create_index(op.f('ix_timetable_semester'), 'timetable', ['semester'], unique=False)
    op.create_index(op.f('ix_timetable_teacher_id'), 'timetable', ['teacher_id'], unique=False)
    op.create_index(op.f('ix_timetable_weekday'), 'timetable', ['weekday'], unique=False)
    op.create_table('teaching_evaluation',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False, comment='评教记录ID'),
    sa.Column('evaluation_no', sa.String(length=64), nullable=False, comment='评教编号'),
    sa.Column('timetable_id', sa.BigInteger(), nullable=False, comment='关联课表ID'),
    sa.Column('teach_teacher_id', sa.BigInteger(), nullable=False, comment='授课教师ID（user.id）'),
    sa.Column('listen_teacher_id', sa.BigInteger(), nullable=False, comment='听课教师ID（user.id）'),
    sa.Column('total_score', mysql.TINYINT(), nullable=False, comment='评教总分（0-100）'),
    sa.Column('dimension_scores', sa.JSON(), nullable=False, comment='各维度得分（JSON）'),
    sa.Column('score_level', sa.String(length=8), nullable=True, comment='等级（优秀/良好/合格/不合格，可空）'),
    sa.Column('advantage_content', sa.Text(), nullable=True, comment='优点描述（可空）'),
    sa.Column('problem_content', sa.Text(), nullable=True, comment='问题描述（可空）'),
    sa.Column('improve_suggestion', sa.Text(), nullable=True, comment='改进建议（可空）'),
    sa.Column('listen_date', sa.DateTime(), nullable=False, comment='实际听课日期'),
    sa.Column('listen_duration', sa.SmallInteger(), nullable=True, comment='听课时长（分钟，可空）'),
    sa.Column('listen_location', sa.String(length=128), nullable=True, comment='实际听课地点（可空）'),
    sa.Column('is_anonymous', sa.Boolean(), nullable=True, comment='是否匿名'),
    sa.Column('status', mysql.TINYINT(), nullable=True, comment='状态 1-有效 0-作废 2-待审核'),
    sa.Column('submit_time', sa.DateTime(), nullable=False, comment='提交时间'),
    sa.Column('create_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='创建时间'),
    sa.Column('update_time', sa.DateTime(), server_default=sa.text('now()'), nullable=True, comment='更新时间'),
    sa.Column('is_delete', sa.Boolean(), nullable=True, comment='逻辑删除'),
    sa.ForeignKeyConstraint(['listen_teacher_id'], ['user.id'], ondelete='RESTRICT'),
    sa.ForeignKeyConstraint(['teach_teacher_id'], ['user.id'], ondelete='RESTRICT'),
    sa.ForeignKeyConstraint(['timetable_id'], ['timetable.id'], ondelete='RESTRICT'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('timetable_id', 'listen_teacher_id', 'listen_date', name='uk_evaluation_unique'),
    comment='教学评价表',
    mysql_charset='utf8mb4',
    mysql_collate='utf8mb4_unicode_ci'
    )
    op.create_index('idx_evaluation_listen_date', 'teaching_evaluation', ['listen_date', 'status'], unique=False)
    op.create_index('idx_evaluation_score_level', 'teaching_evaluation', ['score_level', 'status'], unique=False)
    op.create_index('idx_evaluation_submit', 'teaching_evaluation', ['submit_time', 'is_delete'], unique=False)
    op.create_index('idx_evaluation_teachers', 'teaching_evaluation', ['teach_teacher_id', 'listen_teacher_id'], unique=False)
    op.create_index(op.f('ix_teaching_evaluation_evaluation_no'), 'teaching_evaluation', ['evaluation_no'], unique=True)
    op.create_index(op.f('ix_teaching_evaluation_is_delete'), 'teaching_evaluation', ['is_delete'], unique=False)
    op.create_index(op.f('ix_teaching_evaluation_listen_date'), 'teaching_evaluation', ['listen_date'], unique=False)
    op.create_index(op.f('ix_teaching_evaluation_listen_teacher_id'), 'teaching_evaluation', ['listen_teacher_id'], unique=False)
    op.create_index(op.f('ix_teaching_evaluation_score_level'), 'teaching_evaluation', ['score_level'], unique=False)
    op.create_index(op.f('ix_teaching_evaluation_status'), 'teaching_evaluation', ['status'], unique=False)
    op.create_index(op.f('ix_teaching_evaluation_submit_time'), 'teaching_evaluation', ['submit_time'], unique=False)
    op.create_index(op.f('ix_teaching_evaluation_teach_teacher_id'), 'teaching_evaluation', ['teach_teacher_id'], unique=False)
    op.create_index(op.f('ix_teaching_evaluation_timetable_id'), 'teaching_evaluation', ['timetable_id'], unique=False)
    # ### end Alembic commands ###


def downgrade() -> None:
    """Downgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index(op.f('ix_teaching_evaluation_timetable_id'), table_name='teaching_evaluation')
    op.drop_index(op.f('ix_teaching_evaluation_teach_teacher_id'), table_name='teaching_evaluation')
    op.drop_index(op.f('ix_teaching_evaluation_submit_time'), table_name='teaching_evaluation')
    op.drop_index(op.f('ix_teaching_evaluation_status'), table_name='teaching_evaluation')
    op.drop_index(op.f('ix_teaching_evaluation_score_level'), table_name='teaching_evaluation')
    op.drop_index(op.f('ix_teaching_evaluation_listen_teacher_id'), table_name='teaching_evaluation')
    op.drop_index(op.f('ix_teaching_evaluation_listen_date'), table_name='teaching_evaluation')
    op.drop_index(op.f('ix_teaching_evaluation_is_delete'), table_name='teaching_evaluation')
    op.drop_index(op.f('ix_teaching_evaluation_evaluation_no'), table_name='teaching_evaluation')
    op.drop_index('idx_evaluation_teachers', table_name='teaching_evaluation')
    op.drop_index('idx_evaluation_submit', table_name='teaching_evaluation')
    op.drop_index('idx_evaluation_score_level', table_name='teaching_evaluation')
    op.drop_index('idx_evaluation_listen_date', table_name='teaching_evaluation')
    op.drop_table('teaching_evaluation')
    op.drop_index(op.f('ix_timetable_weekday'), table_name='timetable')
    op.drop_index(op.f('ix_timetable_teacher_id'), table_name='timetable')
    op.drop_index(op.f('ix_timetable_semester'), table_name='timetable')
    op.drop_index(op.f('ix_timetable_is_delete'), table_name='timetable')
    op.drop_index(op.f('ix_timetable_external_id'), table_name='timetable')
    op.drop_index(op.f('ix_timetable_course_name'), table_name='timetable')
    op.drop_index(op.f('ix_timetable_course_code'), table_name='timetable')
    op.drop_index(op.f('ix_timetable_college_id'), table_name='timetable')
    op.drop_index(op.f('ix_timetable_class_id'), table_name='timetable')
    op.drop_index(op.f('ix_timetable_academic_year'), table_name='timetable')
    op.drop_index('idx_timetable_year_semester', table_name='timetable')
    op.drop_index('idx_timetable_schedule', table_name='timetable')
    op.drop_index('idx_timetable_delete', table_name='timetable')
    op.drop_index('idx_timetable_college_teacher', table_name='timetable')
    op.drop_table('timetable')
    op.drop_index(op.f('ix_user_wechat_bind_unionid'), table_name='user_wechat_bind')
    op.drop_index(op.f('ix_user_wechat_bind_openid'), table_name='user_wechat_bind')
    op.drop_table('user_wechat_bind')
    op.drop_index(op.f('ix_user_role_user_id'), table_name='user_role')
    op.drop_index(op.f('ix_user_role_role_id'), table_name='user_role')
    op.drop_table('user_role')
    op.drop_index(op.f('ix_teacher_profile_user_id'), table_name='teacher_profile')
    op.drop_index(op.f('ix_teacher_profile_research_room_id'), table_name='teacher_profile')
    op.drop_index(op.f('ix_teacher_profile_is_delete'), table_name='teacher_profile')
    op.drop_index(op.f('ix_teacher_profile_external_id'), table_name='teacher_profile')
    op.drop_index('idx_teacher_profile_delete', table_name='teacher_profile')
    op.drop_table('teacher_profile')
    op.drop_index(op.f('ix_teacher_evaluation_stat_teacher_id'), table_name='teacher_evaluation_stat')
    op.drop_index(op.f('ix_teacher_evaluation_stat_stat_year'), table_name='teacher_evaluation_stat')
    op.drop_index(op.f('ix_teacher_evaluation_stat_college_id'), table_name='teacher_evaluation_stat')
    op.drop_index('idx_teacher_stat_year_semester', table_name='teacher_evaluation_stat')
    op.drop_index('idx_teacher_stat_college', table_name='teacher_evaluation_stat')
    op.drop_table('teacher_evaluation_stat')
    op.drop_index(op.f('ix_system_config_operator_id'), table_name='system_config')
    op.drop_index(op.f('ix_system_config_config_key'), table_name='system_config')
    op.drop_table('system_config')
    op.drop_index(op.f('ix_operation_log_user_id'), table_name='operation_log')
    op.drop_index(op.f('ix_operation_log_operation_type'), table_name='operation_log')
    op.drop_index(op.f('ix_operation_log_module'), table_name='operation_log')
    op.drop_index(op.f('ix_operation_log_create_time'), table_name='operation_log')
    op.drop_index(op.f('ix_operation_log_create_date'), table_name='operation_log')
    op.drop_index('idx_log_user_time', table_name='operation_log')
    op.drop_index('idx_log_target', table_name='operation_log')
    op.drop_index('idx_log_module_type', table_name='operation_log')
    op.drop_index('idx_log_date', table_name='operation_log')
    op.drop_table('operation_log')
    op.drop_index(op.f('ix_login_log_user_id'), table_name='login_log')
    op.drop_index(op.f('ix_login_log_create_time'), table_name='login_log')
    op.drop_index(op.f('ix_login_log_create_date'), table_name='login_log')
    op.drop_index('idx_login_user_time', table_name='login_log')
    op.drop_index('idx_login_status_time', table_name='login_log')
    op.drop_index('idx_login_date', table_name='login_log')
    op.drop_table('login_log')
    op.drop_index(op.f('ix_clazz_major_id'), table_name='clazz')
    op.drop_index(op.f('ix_clazz_is_delete'), table_name='clazz')
    op.drop_index(op.f('ix_clazz_class_name'), table_name='clazz')
    op.drop_index(op.f('ix_clazz_class_code'), table_name='clazz')
    op.drop_index('idx_clazz_delete', table_name='clazz')
    op.drop_table('clazz')
    op.drop_index(op.f('ix_user_user_on'), table_name='user')
    op.drop_index(op.f('ix_user_status'), table_name='user')
    op.drop_index(op.f('ix_user_is_delete'), table_name='user')
    op.drop_index(op.f('ix_user_college_id'), table_name='user')
    op.drop_index('idx_user_token', table_name='user')
    op.drop_index('idx_user_status_delete', table_name='user')
    op.drop_table('user')
    op.drop_index(op.f('ix_role_permission_role_id'), table_name='role_permission')
    op.drop_index(op.f('ix_role_permission_permission_id'), table_name='role_permission')
    op.drop_table('role_permission')
    op.drop_index(op.f('ix_research_room_is_delete'), table_name='research_room')
    op.drop_index(op.f('ix_research_room_college_id'), table_name='research_room')
    op.drop_index('idx_room_delete', table_name='research_room')
    op.drop_table('research_room')
    op.drop_index(op.f('ix_major_major_code'), table_name='major')
    op.drop_index(op.f('ix_major_is_delete'), table_name='major')
    op.drop_index(op.f('ix_major_college_id'), table_name='major')
    op.drop_index('idx_major_delete', table_name='major')
    op.drop_table('major')
    op.drop_index(op.f('ix_college_evaluation_stat_stat_year'), table_name='college_evaluation_stat')
    op.drop_index(op.f('ix_college_evaluation_stat_college_id'), table_name='college_evaluation_stat')
    op.drop_index('idx_college_stat_year_semester', table_name='college_evaluation_stat')
    op.drop_table('college_evaluation_stat')
    op.drop_index(op.f('ix_role_status'), table_name='role')
    op.drop_index(op.f('ix_role_role_code'), table_name='role')
    op.drop_index(op.f('ix_role_is_delete'), table_name='role')
    op.drop_index('idx_role_status_delete', table_name='role')
    op.drop_table('role')
    op.drop_index(op.f('ix_permission_permission_type'), table_name='permission')
    op.drop_index(op.f('ix_permission_permission_code'), table_name='permission')
    op.drop_index(op.f('ix_permission_parent_id'), table_name='permission')
    op.drop_index(op.f('ix_permission_is_delete'), table_name='permission')
    op.drop_index('idx_permission_type_order', table_name='permission')
    op.drop_table('permission')
    op.drop_index(op.f('ix_operation_log_archive_create_time'), table_name='operation_log_archive')
    op.drop_index(op.f('ix_operation_log_archive_create_date'), table_name='operation_log_archive')
    op.drop_index('idx_archive_user', table_name='operation_log_archive')
    op.drop_index('idx_archive_date', table_name='operation_log_archive')
    op.drop_table('operation_log_archive')
    op.drop_index(op.f('ix_login_log_archive_create_time'), table_name='login_log_archive')
    op.drop_index(op.f('ix_login_log_archive_create_date'), table_name='login_log_archive')
    op.drop_index('idx_login_archive_date', table_name='login_log_archive')
    op.drop_table('login_log_archive')
    op.drop_index(op.f('ix_evaluation_dimension_is_delete'), table_name='evaluation_dimension')
    op.drop_index(op.f('ix_evaluation_dimension_dimension_code'), table_name='evaluation_dimension')
    op.drop_index('idx_dimension_status_order', table_name='evaluation_dimension')
    op.drop_index('idx_dimension_delete', table_name='evaluation_dimension')
    op.drop_table('evaluation_dimension')
    op.drop_index(op.f('ix_college_is_delete'), table_name='college')
    op.drop_index(op.f('ix_college_college_code'), table_name='college')
    op.drop_index('idx_college_delete', table_name='college')
    op.drop_table('college')
    # ### end Alembic commands ###
