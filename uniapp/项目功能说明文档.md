# 教学评价系统 - 功能说明文档

## 项目概述

本系统是一个基于 uni-app 开发的教学质量评价系统，支持 Web 端和微信小程序双平台运行。系统采用本地存储（localStorage）作为数据存储方案，所有数据操作均在本地完成。本文档详细说明每个页面的功能和作用，并标记需要后端接入的功能点。

---

## 目录结构

```
pages/
├── login/              # 登录相关
├── teacher/            # 教师端
├── supervisor/         # 督导端
├── college/            # 学院管理员端
└── school/             # 学校管理员端
```

---

## 一、登录模块

### 1.1 登录页面 (`pages/login/login.vue`)

**功能说明：**
- 用户登录验证
- 根据用户角色跳转到对应的工作台
- 支持教师、督导老师、学院管理员、学校管理员四种角色

**后端接入点：**
- ✅ **登录验证** (`handleLogin` 方法)
  - 当前：使用本地存储验证
  - 待接入：`POST /api/auth/login`
  - 参数：`{ username, password }`
  - 返回：`{ success, token, user }`

---

## 二、教师端模块

### 2.1 教师工作台 (`pages/teacher/index.vue`)

**功能说明：**
- 显示个人课表
- 显示评价统计（总评价数、平均分、当前等级）
- 显示得分趋势图
- 显示最近评价记录
- 快速操作入口（进行评教、查看历史记录）

**后端接入点：**
- ✅ **获取个人课表** (`loadData` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/teacher/courses?teacherId={id}`
  
- ✅ **获取评价统计** (`loadData` 方法)
  - 当前：从本地存储计算
  - 待接入：`GET /api/teacher/evaluations/statistics?teacherId={id}`

- ✅ **获取最近评价记录** (`loadData` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/teacher/evaluations/recent?teacherId={id}&limit=10`

### 2.2 进行评教 (`pages/teacher/evaluate.vue`)

**功能说明：**
- 选择课程进行评教
- 填写评分（100分制，包含教学态度、教学内容、教学方法、教学效果）
- 填写文字建议（优点、问题、改进方向）
- 选择提交状态（课中/课后）
- 匿名评价设置（根据系统配置）

**后端接入点：**
- ✅ **获取课程列表** (`loadCourses` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/teacher/courses?teacherId={id}`

- ✅ **提交评教数据** (`handleSubmit` 方法)
  - 当前：保存到本地存储
  - 待接入：`POST /api/evaluations/submit`
  - 参数：
    ```json
    {
      "courseId": "number",
      "teacherId": "number",
      "evaluatorId": "number",
      "evaluatorRole": "teacher",
      "scores": {
        "teachingAttitude": "number",
        "content": "number",
        "method": "number",
        "effect": "number",
        "detail": "object"
      },
      "totalScore": "number",
      "level": "string",
      "suggestions": {
        "advantages": "string",
        "problems": "string",
        "improvements": "string"
      },
      "submitStatus": "during|after",
      "anonymous": "boolean"
    }
    ```

### 2.3 听课记录 (`pages/teacher/listen.vue`)

**功能说明：**
- 查看个人听课记录
- 显示听课详情（课程、教师、评分、建议）

**后端接入点：**
- ✅ **获取听课记录** (`loadData` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/teacher/listen-records?teacherId={id}`

---

## 三、督导端模块

### 3.1 督导工作台 (`pages/supervisor/index.vue`)

**功能说明：**
- 显示负责范围统计（负责教师数、负责课程数、总评价数、平均分）
- 显示最近评价记录
- 功能入口（查看课表、进行评教、统计分析）

**后端接入点：**
- ✅ **获取负责教师数** (`loadData` 方法)
  - 当前：从本地存储计算
  - 待接入：`GET /api/supervisor/teachers?supervisorId={id}`

- ✅ **获取负责课程数** (`loadData` 方法)
  - 当前：从本地存储计算
  - 待接入：`GET /api/supervisor/courses?supervisorId={id}`

- ✅ **获取总评价数** (`totalEvaluations` 计算属性)
  - 当前：从本地存储计算
  - 待接入：`GET /api/supervisor/evaluations/count?supervisorId={id}`

- ✅ **获取平均分** (`overallAverageScore` 计算属性)
  - 当前：从本地存储计算
  - 待接入：`GET /api/supervisor/evaluations/average?supervisorId={id}`

### 3.2 进行评教 (`pages/supervisor/evaluate.vue`)

**功能说明：**
- 选择负责范围内的课程进行评教
- 填写评分和文字建议
- 选择提交状态（课中/课后）

**后端接入点：**
- ✅ **权限检查** (`checkPermission` 方法)
  - 当前：本地验证
  - 待接入：`GET /api/permissions/can-evaluate?userId={id}`

- ✅ **获取负责范围内的课程** (`loadCourses` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/supervisor/courses?supervisorId={id}`

- ✅ **提交评教数据** (`handleSubmit` 方法)
  - 当前：保存到本地存储
  - 待接入：`POST /api/evaluations/submit`（同教师端）

### 3.3 教师课表 (`pages/supervisor/schedule.vue`)

**功能说明：**
- 查看负责范围内教师的课程安排
- 支持按教师、学期筛选

**后端接入点：**
- ✅ **获取课程列表** (`loadData` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/supervisor/courses?supervisorId={id}&teacherId={id}&semester={semester}`

### 3.4 统计分析 (`pages/supervisor/statistics.vue`)

**功能说明：**
- 显示负责范围内教师的评价汇总数据
- 显示教师排名
- 显示问题统计
- 导出听课记录报表

**后端接入点：**
- ✅ **获取评价汇总数据** (`loadStatistics` 方法)
  - 当前：从本地存储计算
  - 待接入：`GET /api/supervisor/evaluations/summary?supervisorId={id}`

- ✅ **获取问题统计** (`loadProblemStats` 方法)
  - 当前：从本地存储分析
  - 待接入：`GET /api/supervisor/problems/statistics?supervisorId={id}`

- ✅ **导出听课记录报表** (`handleExport` 方法)
  - 当前：提示"功能待接入后端"
  - 待接入：`GET /api/supervisor/export/listen-records?supervisorId={id}`
  - 返回：Excel 文件或 PDF 文件

### 3.5 听课记录 (`pages/supervisor/listen.vue`)

**功能说明：**
- 查看督导老师的听课记录

**后端接入点：**
- ✅ **权限检查** (`checkPermission` 方法)
  - 当前：本地验证
  - 待接入：`GET /api/permissions/can-evaluate?userId={id}`

- ✅ **获取听课记录** (`loadData` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/supervisor/listen-records?supervisorId={id}`

---

## 四、学院管理员端模块

### 4.1 学院管理 (`pages/college/index.vue`)

**功能说明：**
- 显示学院统计概览（教师数、评价数、平均分、听课完成率）
- 显示教师排名
- 快速操作入口（统计分析、数据管理、用户管理、评教通知）

**后端接入点：**
- ✅ **获取学院数据** (`loadData` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/college/data?college={collegeName}`

### 4.2 统计分析 (`pages/college/statistics.vue`)

**功能说明：**
- 显示学院统计概览
- 显示教师排名
- 显示问题统计
- 显示评教详情
- 导出报表

**后端接入点：**
- ✅ **获取学院评价数据** (`loadData` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/college/evaluations?college={collegeName}`

- ✅ **导出报表** (`handleExport` 方法)
  - 当前：提示"导出功能待接入后端"
  - 待接入：`GET /api/college/export/report?college={collegeName}`
  - 返回：Excel 文件或 PDF 文件

### 4.3 用户管理 (`pages/college/users.vue`)

**功能说明：**
- 查看本院用户列表
- 添加用户
- 编辑用户信息
- 重置用户密码
- 删除用户

**后端接入点：**
- ✅ **获取用户列表** (`loadCollegeUsers` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/college/users?college={collegeName}`

- ✅ **添加用户** (`saveUser` 方法)
  - 当前：保存到本地存储
  - 待接入：`POST /api/users`
  - 参数：`{ username, password, name, role, college }`

- ✅ **编辑用户** (`saveUser` 方法)
  - 当前：更新本地存储
  - 待接入：`PUT /api/users/{userId}`
  - 参数：`{ name, password?, role, college }`

- ✅ **删除用户** (`deleteUser` 方法)
  - 当前：从本地存储删除
  - 待接入：`DELETE /api/users/{userId}`

- ✅ **重置密码** (`resetPassword` 方法)
  - 当前：更新本地存储
  - 待接入：`PUT /api/users/{userId}/reset-password`

### 4.4 评教通知 (`pages/college/notices.vue`)

**功能说明：**
- 查看学校下发的评教通知
- 标记通知为已读

**后端接入点：**
- ✅ **获取通知列表** (`loadNotices` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/notices?college={collegeName}`

- ✅ **标记通知已读** (`viewNotice` 方法)
  - 当前：更新本地存储
  - 待接入：`PUT /api/notices/{noticeId}/read`

---

## 五、学校管理员端模块

### 5.1 学校管理 (`pages/school/index.vue`)

**功能说明：**
- 显示全校统计概览（学院数、教师总数、总评价数、全校平均分）
- 显示学院排名
- 显示教师排名（Top 20）
- 快速操作入口（统计分析、系统配置、数据管理、用户管理、通知管理）

**后端接入点：**
- ✅ **获取全校数据** (`loadData` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/school/statistics`

### 5.2 统计分析 (`pages/school/statistics.vue`)

**功能说明：**
- 显示全校统计概览
- 显示学院排名
- 显示教师排名
- 导出报表

**后端接入点：**
- ✅ **获取全校统计数据** (`loadData` 方法)
  - 当前：从本地存储计算
  - 待接入：`GET /api/school/statistics`

- ✅ **导出报表** (`handleExport` 方法)
  - 当前：提示"导出功能待接入后端"
  - 待接入：`GET /api/school/export/report`
  - 返回：Excel 文件或 PDF 文件

### 5.3 系统配置 (`pages/school/config.vue`)

**功能说明：**
- 配置匿名评价模式（全局匿名/可选匿名）
- 配置允许自我听课
- 配置操作日志记录
- 设置当前学期
- 数据备份与恢复
- 数据清理
- 系统维护

**后端接入点：**
- ✅ **保存系统配置** (`saveConfig` 方法)
  - 当前：保存到本地存储
  - 待接入：`PUT /api/admin/config`
  - 参数：
    ```json
    {
      "anonymousMode": "global|optional",
      "globalAnonymous": "boolean",
      "allowSelfListen": "boolean",
      "auditLog": "boolean",
      "currentSemester": "string"
    }
    ```

- ✅ **数据备份** (`handleBackup` 方法)
  - 当前：备份到本地存储
  - 待接入：`POST /api/admin/backup`
  - 返回：备份文件下载链接

- ✅ **数据恢复** (`handleRestore` 方法)
  - 当前：从本地存储恢复
  - 待接入：`POST /api/admin/restore`
  - 参数：备份文件

- ✅ **数据清理** (`handleClearExpiredData`, `handleClearInvalidData` 方法)
  - 当前：清理本地存储
  - 待接入：`POST /api/admin/cleanup`
  - 参数：`{ type: "expired|invalid" }`

### 5.4 用户管理 (`pages/school/users.vue`)

**功能说明：**
- 查看全校用户列表
- 按学院、角色筛选用户
- 添加用户
- 编辑用户信息（包括督导老师的负责范围）
- 重置用户密码
- 删除用户

**后端接入点：**
- ✅ **获取用户列表** (`loadUsers` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/users?college={college}&role={role}`

- ✅ **添加用户** (`saveUser` 方法)
  - 当前：保存到本地存储
  - 待接入：`POST /api/users`
  - 参数：
    ```json
    {
      "username": "string",
      "password": "string",
      "name": "string",
      "role": "teacher|college_admin|supervisor|school_admin",
      "college": "string",
      "responsibleColleges": ["string"],
      "responsibleTeachers": [number]
    }
    ```

- ✅ **编辑用户** (`saveUser` 方法)
  - 当前：更新本地存储
  - 待接入：`PUT /api/users/{userId}`
  - 参数：同添加用户

- ✅ **删除用户** (`deleteUser` 方法)
  - 当前：从本地存储删除
  - 待接入：`DELETE /api/users/{userId}`

- ✅ **重置密码** (`resetPassword` 方法)
  - 当前：更新本地存储
  - 待接入：`PUT /api/users/{userId}/reset-password`

### 5.5 通知管理 (`pages/school/notices.vue`)

**功能说明：**
- 查看所有评教通知
- 发布新通知
- 编辑通知
- 删除通知
- 设置通知发布范围（全部学院/指定学院）

**后端接入点：**
- ✅ **获取通知列表** (`loadNotices` 方法)
  - 当前：从本地存储获取
  - 待接入：`GET /api/notices`

- ✅ **发布通知** (`saveNotice` 方法)
  - 当前：保存到本地存储
  - 待接入：`POST /api/notices`
  - 参数：
    ```json
    {
      "title": "string",
      "content": "string",
      "targetCollege": "all|string"
    }
    ```

- ✅ **编辑通知** (`saveNotice` 方法)
  - 当前：更新本地存储
  - 待接入：`PUT /api/notices/{noticeId}`
  - 参数：同发布通知

- ✅ **删除通知** (`deleteNotice` 方法)
  - 当前：从本地存储删除
  - 待接入：`DELETE /api/notices/{noticeId}`

---

## 六、数据存储模块

### 6.1 数据存储工具 (`utils/simpleStore.js`)

**功能说明：**
- 管理所有本地数据（用户、课程、评价、通知等）
- 提供数据操作方法

**后端接入点：**
- ✅ **获取督导老师负责的教师** (`getSupervisorTeachers` 方法)
  - 当前：从本地存储筛选
  - 待接入：`GET /api/supervisor/teachers?supervisorId={id}`

- ✅ **获取督导老师负责的课程** (`getSupervisorCourses` 方法)
  - 当前：从本地存储筛选
  - 待接入：`GET /api/supervisor/courses?supervisorId={id}`

- ✅ **获取督导老师评价汇总** (`getSupervisorEvaluationsSummary` 方法)
  - 当前：从本地存储计算
  - 待接入：`GET /api/supervisor/evaluations/summary?supervisorId={id}`

- ✅ **获取督导老师听课记录** (`getSupervisorListenRecords` 方法)
  - 当前：从本地存储筛选
  - 待接入：`GET /api/supervisor/listen-records?supervisorId={id}`

- ✅ **检查评教权限** (`canEvaluate` 方法)
  - 当前：本地验证
  - 待接入：`GET /api/permissions/can-evaluate?userId={id}`

---

## 七、后端接口汇总

### 7.1 认证接口

| 接口 | 方法 | 说明 | 状态 |
|------|------|------|------|
| `/api/auth/login` | POST | 用户登录 | ⏳ 待接入 |

### 7.2 评价接口

| 接口 | 方法 | 说明 | 状态 |
|------|------|------|------|
| `/api/evaluations/submit` | POST | 提交评教数据 | ⏳ 待接入 |
| `/api/teacher/evaluations/statistics` | GET | 获取教师评价统计 | ⏳ 待接入 |
| `/api/teacher/evaluations/recent` | GET | 获取最近评价记录 | ⏳ 待接入 |
| `/api/supervisor/evaluations/count` | GET | 获取督导评价总数 | ⏳ 待接入 |
| `/api/supervisor/evaluations/average` | GET | 获取督导评价平均分 | ⏳ 待接入 |
| `/api/supervisor/evaluations/summary` | GET | 获取督导评价汇总 | ⏳ 待接入 |

### 7.3 课程接口

| 接口 | 方法 | 说明 | 状态 |
|------|------|------|------|
| `/api/teacher/courses` | GET | 获取教师课程列表 | ⏳ 待接入 |
| `/api/supervisor/courses` | GET | 获取督导负责课程 | ⏳ 待接入 |

### 7.4 用户接口

| 接口 | 方法 | 说明 | 状态 |
|------|------|------|------|
| `/api/users` | GET | 获取用户列表 | ⏳ 待接入 |
| `/api/users` | POST | 添加用户 | ⏳ 待接入 |
| `/api/users/{userId}` | PUT | 更新用户 | ⏳ 待接入 |
| `/api/users/{userId}` | DELETE | 删除用户 | ⏳ 待接入 |
| `/api/users/{userId}/reset-password` | PUT | 重置密码 | ⏳ 待接入 |
| `/api/college/users` | GET | 获取学院用户列表 | ⏳ 待接入 |

### 7.5 督导接口

| 接口 | 方法 | 说明 | 状态 |
|------|------|------|------|
| `/api/supervisor/teachers` | GET | 获取负责教师 | ⏳ 待接入 |
| `/api/supervisor/listen-records` | GET | 获取听课记录 | ⏳ 待接入 |

### 7.6 统计接口

| 接口 | 方法 | 说明 | 状态 |
|------|------|------|------|
| `/api/college/evaluations` | GET | 获取学院评价数据 | ⏳ 待接入 |
| `/api/college/data` | GET | 获取学院数据 | ⏳ 待接入 |
| `/api/school/statistics` | GET | 获取全校统计数据 | ⏳ 待接入 |

### 7.7 导出接口

| 接口 | 方法 | 说明 | 状态 |
|------|------|------|------|
| `/api/supervisor/export/listen-records` | GET | 导出督导听课记录 | ⏳ 待接入 |
| `/api/college/export/report` | GET | 导出学院报表 | ⏳ 待接入 |
| `/api/school/export/report` | GET | 导出全校报表 | ⏳ 待接入 |

### 7.8 通知接口

| 接口 | 方法 | 说明 | 状态 |
|------|------|------|------|
| `/api/notices` | GET | 获取通知列表 | ⏳ 待接入 |
| `/api/notices` | POST | 发布通知 | ⏳ 待接入 |
| `/api/notices/{noticeId}` | PUT | 更新通知 | ⏳ 待接入 |
| `/api/notices/{noticeId}` | DELETE | 删除通知 | ⏳ 待接入 |
| `/api/notices/{noticeId}/read` | PUT | 标记已读 | ⏳ 待接入 |

### 7.9 配置接口

| 接口 | 方法 | 说明 | 状态 |
|------|------|------|------|
| `/api/admin/config` | PUT | 保存系统配置 | ⏳ 待接入 |
| `/api/admin/backup` | POST | 数据备份 | ⏳ 待接入 |
| `/api/admin/restore` | POST | 数据恢复 | ⏳ 待接入 |
| `/api/admin/cleanup` | POST | 数据清理 | ⏳ 待接入 |

### 7.10 权限接口

| 接口 | 方法 | 说明 | 状态 |
|------|------|------|------|
| `/api/permissions/can-evaluate` | GET | 检查评教权限 | ⏳ 待接入 |

---

## 八、注意事项

### 8.1 数据格式

所有接口应遵循统一的响应格式：

```json
{
  "success": true,
  "data": {},
  "message": "操作成功"
}
```

错误响应：

```json
{
  "success": false,
  "error": "错误信息",
  "code": "ERROR_CODE"
}
```

### 8.2 认证方式

所有需要认证的接口应在请求头中携带 token：

```
Authorization: Bearer {token}
```

### 8.3 分页参数

列表接口应支持分页：

```
GET /api/users?page=1&pageSize=20
```

### 8.4 文件导出

导出接口应返回文件下载链接或直接返回文件流。

---

## 九、开发建议

1. **接口设计**：建议使用 RESTful API 设计规范
2. **错误处理**：统一错误码和错误信息格式
3. **数据验证**：后端应进行严格的数据验证
4. **权限控制**：后端应实现细粒度的权限控制
5. **性能优化**：对于统计数据，建议使用缓存机制
6. **日志记录**：记录所有关键操作日志

---

## 十、状态说明

- ✅ **已完成**：功能已实现，使用本地存储
- ⏳ **待接入**：功能已实现，需要接入后端接口
- ❌ **未实现**：功能尚未实现

---

 


